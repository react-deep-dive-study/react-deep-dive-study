## 12

### 이야깃거리

1. 웹 페이지 퍼포먼스 개선은 PO/PM이 제시해야하는 걸까, 프론트로 부터 제시해야하는 걸까? 프론트가 제시해야한다면 다른 태스크들의 우선순위와 어떻게 비교될까?
2. 같은 오리진이 아닌 경우 새로운 네트워크 요청을 연다는게 무슨 말일까? 레퍼런스가 궁금함 (p.787쪽 하단에서 언급)

### 퍼포먼스가 웹 페이지에 미치는 영향

- 1초이내에 페이지가 반응하지 않는다면, 사용자들이 대부분 안좋은 경험을 가져가기 때문에 주의를 가져야 함
- 하지만, 이렇나 개선작업은 어렵고 성과로 드러나기 어려움 (#이야깃거리 1)

### LCP

LCP: 화면의 가장 큰 컨텐츠가 보여지는데 까지 걸리는 시간

- 주로 이미지, 텍스트 같은 컨텐츠가 보이는데 걸리는 시간, 2.5초 이내에 걸리는 것이 좋다.

#### LCP 개선

- 가능하다면 서버에서 빌드해서 내려준다면 빠른 LCP를 얻을 수 있다
- 이미지를 사용한다면 LCP에 사용되지 않게 해보자
  - 만약 필요하다면 무손실 압축 및 img 태그 사용, lazy로드나 background-image는 느릴 수 있다, 같은 오리진을 사용하는 것이 네트워크 요청을 새로 만들지 않기에 유리하다 (#이야깃거리 2)

### FID

FID: 처음으로 웹페이지가 반응하기까지 걸리는 속도

- 이러한 반응성이 느려지는 경우는 메인 스레드에서 다른 일을하고 있기 때문이다. 메인 스레드가 작업을 할 수 있게 비워줘야 유리하다.

- 100ms 이내로 응답이 되어야함

#### FID 개선

- 웹 페이지에서 꼭 해야하는 연산이 아니라면 서버에서 해서 받아오는 것도 방법, 싱글 스레드에서 무거운 연산이 동작하여 반응성이 안좋아질 수 있기 때문
- 자바스크립트 파일을 해석하는 과정도 CPU를 사용하기에 자바스크립트 번들 사이즈 줄이기
- 폴리필의 경우 자바스크립트의 용량이 커질 수 있기 때문에 필요한 환경에서만 적용하기
- 타사 라이브러리의 경우 async, defer나 intersection observer를 이용하여 최대한 메인 스레드의 점유 시간을 뒤로 미루거나 영향을 적게해야함

### CLS

CLS: 페이지에서 레이아웃 이동이 일어나는 경우에 대해 지표로 나타낸 것

- 뷰포트 내에서의 레이아웃 이동만 계산되며, 레이아웃의 변경없이 추가되는 것은 포함되지 않으며, 유저의 인터렌셕으로 발생하는 레이아웃 변경도 포함되지 않음

#### CLS 개선

- 로딩 중에 스켈레톤으로 이러한 문제를 줄일 수 있음
- 사용자가 볼 UI를 HTML 단계에서 미리 레이아웃 구조를 잡아둔다면 레이아웃 변경이 덜 일어날 수 있음
- 동적인 요소는 예상을 해서 레이아웃을 잡을 수 있으나, 서버 사이드에서 요소를 레이아웃에 넣어서 오는 것이 더 좋음
- 폰트 로딩에도 문제가 생길 수 있음, 중요한 폰트는 <link>의 preload를 이용하거나 실패한다면 기본 폰트를 제공하는 것도 방법
- width: 100%, height: auto와 이미지의 width, height를 지정하는 방법과 srcset을 이용하는 방법

### 이외의 지표

#### TTFB

TTFB: 사용자가 첫 번째 바이트를 수신하는데 걸리는 시간

- 최초 응답 시간이면 600ms 이하가 필요
- 서버 사이드 렌더링의 경우 신경써야 함
  - 필요한 요청을 캐싱
  - 사용자와 가까운 지역의 서버를 사용

#### FCP

FCP: 웹 페이지에 어떠한 것이라도 보이기 시작한 시간

- 1.8초 이내가 필요
- 렌더링 가로막는 요소 최소화
- 바로 보여야하는 요소를 lazy하게 불러오거나 하지 않아야함
- 리다이렉트는 피하는게 좋음
- DOM 크기를 줄이는게 유리
